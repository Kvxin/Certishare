import{d as e,m as t,a as l,j as a,o,b as s,w as n,e as u,n as r,q as i,t as c,I as d,r as p,k as m,F as f,p as _,s as g,i as v,g as h,y,$ as w,z as C,R as b,T as x,h as k,x as B,u as j,U as O}from"./index-b4edc82c.js";import{_ as V}from"./uni-nav-bar.cac3dca4.js";import{r as T}from"./uni-app.es.370d9c9e.js";import{_ as S}from"./uni-icons.ec5d01d1.js";import{_ as $}from"./u-button.0cd44736.js";import{_ as z}from"./u-line.603ce58b.js";import{_ as U}from"./u-loading-icon.c59f05cd.js";import{_ as I}from"./u-popup.676fa4b4.js";import{_ as H}from"./_plugin-vue_export-helper.1b428a4d.js";import{u as R}from"./userStore.7c6883df.js";import{s as D}from"./request.5e8d59d2.js";import{u as F}from"./u-text.31997def.js";import"./u-icon.9d2312a5.js";import"./u-transition.c5fa413b.js";import"./u-status-bar.ced27262.js";const P=H({name:"u-modal",mixins:[t,l,{props:{show:{type:Boolean,default:e.modal.show},title:{type:[String],default:e.modal.title},content:{type:String,default:e.modal.content},confirmText:{type:String,default:e.modal.confirmText},cancelText:{type:String,default:e.modal.cancelText},showConfirmButton:{type:Boolean,default:e.modal.showConfirmButton},showCancelButton:{type:Boolean,default:e.modal.showCancelButton},confirmColor:{type:String,default:e.modal.confirmColor},cancelColor:{type:String,default:e.modal.cancelColor},buttonReverse:{type:Boolean,default:e.modal.buttonReverse},zoom:{type:Boolean,default:e.modal.zoom},asyncClose:{type:Boolean,default:e.modal.asyncClose},closeOnClickOverlay:{type:Boolean,default:e.modal.closeOnClickOverlay},negativeTop:{type:[String,Number],default:e.modal.negativeTop},width:{type:[String,Number],default:e.modal.width},confirmButtonShape:{type:String,default:e.modal.confirmButtonShape}}}],data:()=>({loading:!1}),watch:{show(e){e&&this.loading&&(this.loading=!1)}},emits:["confirm","cancel","close"],methods:{confirmHandler(){this.asyncClose&&(this.loading=!0),this.$emit("confirm")},cancelHandler(){this.$emit("cancel")},clickHandler(){this.closeOnClickOverlay&&this.$emit("close")}}},[["render",function(e,t,l,h,y,w){const C=g,b=v,x=T(a("u-line"),z),k=T(a("u-loading-icon"),U),B=T(a("u-popup"),I);return o(),s(B,{mode:"center",zoom:e.zoom,show:e.show,customStyle:{borderRadius:"6px",overflow:"hidden",marginTop:`-${e.$u.addUnit(e.negativeTop)}`},closeOnClickOverlay:e.closeOnClickOverlay,safeAreaInsetBottom:!1,duration:400,onClick:w.clickHandler},{default:n((()=>[u(b,{class:"u-modal",style:r({width:e.$u.addUnit(e.width)})},{default:n((()=>[e.title?(o(),s(C,{key:0,class:"u-modal__title"},{default:n((()=>[i(c(e.title),1)])),_:1})):d("",!0),u(b,{class:"u-modal__content",style:r({paddingTop:(e.title?12:25)+"px"})},{default:n((()=>[p(e.$slots,"default",{},(()=>[u(C,{class:"u-modal__content__text"},{default:n((()=>[i(c(e.content),1)])),_:1})]),!0)])),_:3},8,["style"]),e.$slots.confirmButton?(o(),s(b,{key:1,class:"u-modal__button-group--confirm-button"},{default:n((()=>[p(e.$slots,"confirmButton",{},void 0,!0)])),_:3})):(o(),m(f,{key:2},[u(x),u(b,{class:"u-modal__button-group",style:r({flexDirection:e.buttonReverse?"row-reverse":"row"})},{default:n((()=>[e.showCancelButton?(o(),s(b,{key:0,class:_(["u-modal__button-group__wrapper u-modal__button-group__wrapper--cancel",[e.showCancelButton&&!e.showConfirmButton&&"u-modal__button-group__wrapper--only-cancel"]]),"hover-stay-time":150,"hover-class":"u-modal__button-group__wrapper--hover",onClick:w.cancelHandler},{default:n((()=>[u(C,{class:"u-modal__button-group__wrapper__text",style:r({color:e.cancelColor})},{default:n((()=>[i(c(e.cancelText),1)])),_:1},8,["style"])])),_:1},8,["class","onClick"])):d("",!0),e.showConfirmButton&&e.showCancelButton?(o(),s(x,{key:1,direction:"column"})):d("",!0),e.showConfirmButton?(o(),s(b,{key:2,class:_(["u-modal__button-group__wrapper u-modal__button-group__wrapper--confirm",[!e.showCancelButton&&e.showConfirmButton&&"u-modal__button-group__wrapper--only-confirm"]]),"hover-stay-time":150,"hover-class":"u-modal__button-group__wrapper--hover",onClick:w.confirmHandler},{default:n((()=>[y.loading?(o(),s(k,{key:0})):(o(),s(C,{key:1,class:"u-modal__button-group__wrapper__text",style:r({color:e.confirmColor})},{default:n((()=>[i(c(e.confirmText),1)])),_:1},8,["style"]))])),_:1},8,["class","onClick"])):d("",!0)])),_:1},8,["style"])],64))])),_:3},8,["style"])])),_:3},8,["zoom","show","customStyle","closeOnClickOverlay","onClick"])}],["__scopeId","data-v-fef61a0c"]]);const q=H({__name:"LoginWarp",emits:["toggle"],setup(e,{emit:t}){const l=h(!1),r=h(""),c=h(""),d=R(),p=()=>{w("changeFlipped")},m=()=>{r.value&&c.value?function(e,t){return D.post("/login",{email:e,password:t})}(r.value,c.value).then((e=>{const t={token:e.data.token,userData:e.data.userData};d.setUser(t),b({url:"/pages/index/index"})})).catch((e=>{C({title:"账号或密码填写错误",icon:"none"})})):C({title:"请填写所有字段",icon:"none"})},f=()=>{setTimeout((()=>{l.value=!1}),500)};return(e,t)=>{const d=g,_=x,h=v,w=T(a("up-button"),$),C=T(a("u-modal"),P);return o(),s(h,{class:"login-form-warp"},{default:n((()=>[u(h,{class:"login-form"},{default:n((()=>[u(h,{class:"username-input inputs"},{default:n((()=>[u(d,{class:"input-text"},{default:n((()=>[i("输入邮箱")])),_:1}),u(_,{type:"text",placeholder:"请输入邮箱",modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e)},null,8,["modelValue"])])),_:1}),u(h,{class:"password-input inputs"},{default:n((()=>[u(d,{class:"input-text"},{default:n((()=>[i("输入密码")])),_:1}),u(_,{type:"password",placeholder:"请输入密码",modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e)},null,8,["modelValue"])])),_:1}),u(h,{class:"no-account"},{default:n((()=>[y("p",{class:"p"},[i(" 没有账号? "),y("span",{onClick:p,class:"span"},"立即注册!")])])),_:1}),u(h,{class:"button-input"},{default:n((()=>[u(w,{type:"primary",text:"登录",shape:"circle",class:"login-button",onClick:m})])),_:1})])),_:1}),u(h,null,{default:n((()=>[u(C,{show:l.value,onConfirm:f,ref:"uModal",asyncClose:!0,closeOnClickOverlay:!0,zoom:!0,title:"提示"},null,8,["show"])])),_:1})])),_:1})}}},[["__scopeId","data-v-18f87b7c"]]);const A=H({__name:"RegisterWarp",emits:["toggle"],setup(e,{emit:t}){const l=h(!1);h("");const r=h("获取验证码"),c=h(null),d=h(""),p=h(""),m=h(""),f=t,_=()=>{w("changeFlipped")},b=()=>{(function(e){return D.post("/register",{userData:e})})({email:d.value,password:p.value,code:m.value}).then((e=>{w("changeFlipped")}))},k=()=>{d.value?function(e){return D.post("/sendVerification",{email:e})}(d.value).then((e=>{j()})):C({title:"请填写邮箱",icon:"none"})},B=()=>{setTimeout((()=>{l.value=!1}),500)},j=()=>{if(c.value)return;let e=60;r.value=`${e}秒`,c.value=setInterval((()=>{e--,r.value=`${e}秒`,e<=0&&(clearInterval(c.value),c.value=null,r.value="获取验证码")}),1e3)},O=()=>{d.value&&p.value&&m.value?(f("toggle"),b()):C({title:"请填写所有字段",icon:"none"})};return(e,t)=>{const c=g,f=x,h=v,w=T(a("up-text"),F),C=T(a("up-button"),$),b=T(a("u-modal"),P);return o(),s(h,{class:"register-form-warp"},{default:n((()=>[u(h,{class:"register-form"},{default:n((()=>[u(h,{class:"username-input inputs"},{default:n((()=>[u(c,{class:"input-text"},{default:n((()=>[i("输入邮箱")])),_:1}),u(f,{type:"text",placeholder:"请输入邮箱",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e)},null,8,["modelValue"])])),_:1}),u(h,{class:"password-input inputs"},{default:n((()=>[u(c,{class:"input-text"},{default:n((()=>[i("输入密码")])),_:1}),u(f,{type:"password",placeholder:"请输入密码",modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=e=>p.value=e)},null,8,["modelValue"])])),_:1}),u(h,{class:"password-input inputs code"},{default:n((()=>[u(c,{class:"input-text"},{default:n((()=>[i("输入验证码")])),_:1}),u(h,{class:"code-warp"},{default:n((()=>[u(f,{type:"text",placeholder:"请输入验证码",modelValue:m.value,"onUpdate:modelValue":t[2]||(t[2]=e=>m.value=e)},null,8,["modelValue"]),u(w,{text:r.value,type:"primary",onClick:k},null,8,["text"])])),_:1})])),_:1}),u(h,{class:"no-account"},{default:n((()=>[y("p",{class:"p"},[i(" 已有账号? "),y("span",{onClick:_,class:"span"},"返回登录")])])),_:1}),u(h,{class:"button-input"},{default:n((()=>[u(C,{type:"primary",text:"注册",shape:"circle",class:"register-button",onClick:O})])),_:1})])),_:1}),u(h,null,{default:n((()=>[u(b,{show:l.value,onConfirm:B,ref:"uModal",asyncClose:!0,closeOnClickOverlay:!0,zoom:!0,title:"提示"},null,8,["show"])])),_:1})])),_:1})}}},[["__scopeId","data-v-1234f076"]]),M={login:{loginPage:{text:{title:"欢迎回来！",prompt:"输入账号密码以登录或者注册一个账户"},field:{username:"输入邮箱或者用户名",password:"输入密码",placeholder:{username:"请输入邮箱",password:"请输入密码"},tips:{p:"没有账号?",span:"立即注册!"},model:"提示",button:"登录"}}}},N=H({__name:"login",setup(e){M.login.loginPage.field,h(!0);const t=h(!1),l=h(!1),r=()=>{O()};return k((()=>{B("changeFlipped",(()=>{t.value=!t.value,setTimeout((()=>{l.value=t.value}),300)}))})),(e,i)=>{const d=T(a("uni-nav-bar"),V),p=T(a("uni-icons"),S),m=v;return o(),s(m,{class:"login-page",style:{width:"100%"}},{default:n((()=>[u(d,{border:!1,"background-color":"#fafafa"}),u(m,{class:"back"},{default:n((()=>[u(p,{type:"arrow-left",size:"32",onClick:r})])),_:1}),u(m,{class:"login-top"},{default:n((()=>[y("h1",null,c(j(M).login.loginPage.text.title),1),y("p",{class:"pp"},c(j(M).login.loginPage.text.prompt),1)])),_:1}),u(m,{class:"login-warp"},{default:n((()=>[u(m,{class:_(["login-div",{"is-flipped":t.value}])},{default:n((()=>[u(m,{class:_(["r",{hide:l.value}])},{default:n((()=>[u(q)])),_:1},8,["class"]),u(m,{class:_(["r back-warp",{hide:!l.value}])},{default:n((()=>[u(A)])),_:1},8,["class"])])),_:1},8,["class"])])),_:1}),u(m,{class:"login-other"}),u(m,{class:"login-bottom"}),u(m)])),_:1})}}},[["__scopeId","data-v-82e33498"]]);export{N as default};
