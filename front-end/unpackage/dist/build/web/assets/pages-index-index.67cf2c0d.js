import{d as t,m as e,a as s,c as a,o as i,b as l,w as o,e as n,n as c,r as u,i as r,f as d,g as p,h as m,j as _,u as h,k as v,F as g,l as f,p as y,q as k,t as x,$ as b,s as C,v as S,x as w,y as I,z as T,A as N,S as $,B as j,C as z,D as O,E as D,G as E,H,I as L,J as F,K as q,L as P,M as U,N as W,O as B,P as J,Q as M}from"./index-b4edc82c.js";import{_ as R}from"./_plugin-vue_export-helper.1b428a4d.js";import{r as A,o as X,a as Y}from"./uni-app.es.370d9c9e.js";import{_ as Z}from"./u-navbar.d4902a1a.js";import{_ as G}from"./u-search.7c85f57a.js";import{_ as V}from"./u-image.f2d47922.js";import{s as K}from"./request.5e8d59d2.js";import{g as Q,a as tt}from"./card.29f73743.js";import{s as et,C as st}from"./Card.d0e0c0ce.js";import{_ as at}from"./uni-icons.ec5d01d1.js";import{u as it}from"./userStore.7c6883df.js";import{_ as lt}from"./u-icon.9d2312a5.js";import{g as ot}from"./post.c2a45bd9.js";import"./u-status-bar.ced27262.js";import"./u-loading-icon.c59f05cd.js";import"./u-transition.c5fa413b.js";const nt=R({name:"u-sticky",mixins:[e,s,{props:{offsetTop:{type:[String,Number],default:t.sticky.offsetTop},customNavHeight:{type:[String,Number],default:44},disabled:{type:Boolean,default:t.sticky.disabled},bgColor:{type:String,default:t.sticky.bgColor},zIndex:{type:[String,Number],default:t.sticky.zIndex},index:{type:[String,Number],default:t.sticky.index}}}],data:()=>({cssSticky:!1,stickyTop:0,elId:uni.$u.guid(),left:0,width:"auto",height:"auto",fixed:!1}),computed:{style(){const t={};return this.disabled?t.position="static":this.cssSticky?(t.position="sticky",t.zIndex=this.uZindex,t.top=uni.$u.addUnit(this.stickyTop)):t.height=this.fixed?this.height+"px":"auto",t.backgroundColor=this.bgColor,uni.$u.deepMerge(uni.$u.addStyle(this.customStyle),t)},stickyContent(){const t={};return this.cssSticky||(t.position=this.fixed?"fixed":"static",t.top=this.stickyTop+"px",t.left=this.left+"px",t.width="auto"==this.width?"auto":this.width+"px",t.zIndex=this.uZindex),t},uZindex(){return this.zIndex?this.zIndex:uni.$u.zIndex.sticky}},mounted(){this.init()},methods:{init(){this.getStickyTop(),this.checkSupportCssSticky(),this.cssSticky||!this.disabled&&this.initObserveContent()},initObserveContent(){this.$uGetRect("#"+this.elId).then((t=>{this.height=t.height,this.left=t.left,this.width=t.width,this.$nextTick((()=>{this.observeContent()}))}))},observeContent(){this.disconnectObserver("contentObserver");const t=a({thresholds:[.95,.98,1]});t.relativeToViewport({top:-this.stickyTop}),t.observe(`#${this.elId}`,(t=>{this.setFixed(t.boundingClientRect.top)})),this.contentObserver=t},setFixed(t){const e=t<=this.stickyTop;this.fixed=e},disconnectObserver(t){const e=this[t];e&&e.disconnect()},getStickyTop(){this.stickyTop=uni.$u.getPx(this.offsetTop)+uni.$u.getPx(this.customNavHeight)},async checkSupportCssSticky(){this.checkCssStickyForH5()&&(this.cssSticky=!0),"android"===uni.$u.os()&&Number(uni.$u.sys().system)>8&&(this.cssSticky=!0),"ios"===uni.$u.os()&&(this.cssSticky=!0)},checkComputedStyle(){},checkCssStickyForH5(){const t=["","-webkit-","-ms-","-moz-","-o-"],e=t.length,s=document.createElement("div");for(let a=0;a<e;a++)if(s.style.position=t[a]+"sticky",""!==s.style.position)return!0;return!1}},beforeUnmount(){this.disconnectObserver("contentObserver")}},[["render",function(t,e,s,a,d,p){const m=r;return i(),l(m,{class:"u-sticky",id:d.elId,style:c([p.style])},{default:o((()=>[n(m,{style:c([p.stickyContent]),class:"u-sticky__content"},{default:o((()=>[u(t.$slots,"default",{},void 0,!0)])),_:3},8,["style"])])),_:3},8,["id","style"])}],["__scopeId","data-v-9d6ec116"]]);d("counter",{state:()=>({count:0}),getters:{},actions:{increment(){this.count++}}});const ct=R({__name:"NavWarp",setup(t){const e=p([{text:"首页"},{text:"社区 "}]);let s=p(0),a=p(0);return m((()=>{})),(t,u)=>{const d=C,p=r,m=A(_("u-navbar"),Z);return i(),l(m,null,{left:o((()=>[n(p,{class:"nav-warp",style:c({marginTop:h(a)+"rpx"})},{default:o((()=>[n(p,{class:"nav-warp-itemss"},{default:o((()=>[(i(!0),v(g,null,f(e.value,((t,e)=>(i(),l(p,{class:y(["nav-item",{active:e==h(s)}]),onClick:t=>(t=>{s.value=t,b("change-page",0===t)})(e)},{default:o((()=>[n(d,null,{default:o((()=>[k(x(t.text),1)])),_:2},1024)])),_:2},1032,["onClick","class"])))),256))])),_:1})])),_:1},8,["style"])])),_:1})}}},[["__scopeId","data-v-d1b2a9b0"]]),ut=R({__name:"SearchWarp",setup(t){const e=p({display:"none"}),s=()=>{S({url:"/pages/search/search"})};return(t,a)=>{const c=A(_("u-search"),G),u=r;return i(),l(u,{class:"search-warp"},{default:o((()=>[n(u,{class:"search-box"},{default:o((()=>[n(c,{placeholder:"点击搜索",shape:"square",clearabled:!0,disabled:"",actionText:"",actionStyle:e.value,onClick:s},null,8,["actionStyle"])])),_:1})])),_:1})}}},[["__scopeId","data-v-d3c7543a"]]);const rt=R({__name:"CarouselWarp",setup(t){const e=p([]),s=p([]),a=t=>{const e=s.value[t].cardId;S({url:`/pages/card-info/card-info?id=${e}`})};return m((()=>{K.get("/getAllCarousels").then((t=>{s.value=t.data.data,s.value.forEach((t=>{const s={image:t.images[0].imageUrl,title:t.title};e.value.push(s)}))}))})),(t,s)=>{const c=A(_("u-swiper"),V),u=r;return i(),l(u,{class:"carousel-warp"},{default:o((()=>[n(u,{class:"carousel-box"},{default:o((()=>[n(c,{list:e.value,showTitle:"",keyName:"image",onClick:a,indicator:"",indicatorMode:"line",circular:"",height:"300rpx"},null,8,["list"])])),_:1})])),_:1})}}},[["__scopeId","data-v-8f5486e9"]]),dt=R({__name:"CardWarp",setup(t){const e=p([]),s=p([]),u=p([]),d=p(1e3);et().getSystemNav;const _=p(!1);let h=z();function y(){s.value=[],u.value=[],e.value.forEach(((t,e)=>{e%2==0?s.value.push(t):u.value.push(t)}))}const x=t=>{"推荐"!=t&&(_.value=!0,tt(t).then((t=>{200==t.data.code?(T({title:"获取成功",icon:"none"}),e.value=t.data.cardList,e.value=O(e.value),y(),setTimeout((()=>{E()}))):T({title:`${t.data.error}`,icon:"none"})})).finally((()=>{_.value=!1})))},C=()=>{Q().then((t=>{e.value=[...e.value,...t.data],e.value=O(e.value),y(),setTimeout((()=>{E()}))}))},O=t=>(t.forEach((t=>{t.images&&t.images.length>0&&(t.images=t.images.map((t=>`${t}?imageMogr2/auto-orient/thumbnail/!30p/interlace/1/blur/1x0/quality/75`)))})),t),D=t=>{S({url:`/pages/card-info/card-info?id=${t}`})},E=()=>{N().in(h).select(".card-warp").boundingClientRect((t=>{let e=JSON.parse(JSON.stringify(t));d.value=e.height})).exec()},H=t=>{const e=t.detail.current;b("changeNav",e)};return m((async()=>{b("showLodding"),w("changeCardDatas",x),await(async()=>{await Q().then((t=>{e.value=t.data,e.value=O(e.value)}))})(),y(),setTimeout((()=>{E(),b("closeLodding"),(()=>{const t=a(h,{thresholds:[.9]});t.relativeToViewport({bottom:20}),t.observe(".load__more",(t=>{t.intersectionRatio>0&&C()}))})()}))})),(t,e)=>{const a=r,p=$,m=j;return i(),l(m,{style:c({height:d.value+150+"px"}),onChange:H},{default:o((()=>[n(p,null,{default:o((()=>[n(a,{class:"card-warp"},{default:o((()=>[I("div",{class:"card-left"},[(i(!0),v(g,null,f(s.value,((t,e)=>(i(),l(st,{key:t.id,cardInfo:t,onClick:e=>D(t._id)},null,8,["cardInfo","onClick"])))),128))]),I("div",{class:"card-right"},[(i(!0),v(g,null,f(u.value,((t,e)=>(i(),l(st,{key:t.id,cardInfo:t,onClick:e=>D(t._id)},null,8,["cardInfo","onClick"])))),128))])])),_:1}),n(a,{class:"load__more"},{default:o((()=>[k("加载更多")])),_:1})])),_:1})])),_:1},8,["style"])}}},[["__scopeId","data-v-242dd367"]]);const pt=R({__name:"NavBar",setup(t){const e=p([]),s=p(!1),a=et(),n=t=>{const s=e.value[t].name;e.value.forEach(((e,s)=>{e.isSelect=s===t})),b("changeCardDatas",s)},c=async()=>{const t=await K.get("/getNav"),{navData:s}=t.data;e.value=(t=>t.map((t=>({...t,isSelect:!1}))))(s),a.setNavBar(e.value),n(0)},u=()=>{s.value=!0},d=()=>{s.value=!1};return m((async()=>{await c(),w("stickyNav",(()=>{u()})),w("noStickyNav",(()=>{d()})),w("changeNav",(t=>{n(t)}))})),O((()=>{D("stickyNav",u),D("noStickyNav",d),D("changeNav",n)})),(t,a)=>{const c=r,u=E;return i(),l(u,{class:y(["scroll-view_H",{"sticky-nav":s.value}]),"scroll-with-animation":"","scroll-x":"true","scroll-left":"120"},{default:o((()=>[(i(!0),v(g,null,f(e.value,((t,e)=>(i(),l(c,{class:y(["scroll-view-item_H",{active:t.isSelect}]),onClick:t=>n(e)},{default:o((()=>[k(x(t.name),1)])),_:2},1032,["class","onClick"])))),256))])),_:1},8,["class"])}}},[["__scopeId","data-v-b9132c66"]]),mt=R({__name:"drag",setup(t){const e=p(100),s=p(15),a=p(0),u=p(0),d=it(),h=p(!1);function v(t){h.value=!0;const e=t.changedTouches[0];a.value=e.pageX,u.value=e.pageY}function g(t){h.value=!0;const i=t.changedTouches[0],l=i.pageX-a.value,o=i.pageY-u.value;a.value=i.pageX,u.value=i.pageY,s.value-=l,e.value-=o,F("xy",{right:s.value,bottom:e.value})}function f(t){t.changedTouches[0],h.value=!1}function y(){d.getUserData?S({url:"/pages/post-page/post-page"}):(T({title:"未登录，请先登录 ",icon:"error"}),S({url:"/pages/login/login"}))}return m((()=>{const t=H("xy");t&&(e.value=t.bottom,s.value=t.right)})),(t,a)=>{const u=r,d=A(_("uni-icons"),at);return i(),l(u,{class:"scan-fixed",style:c({bottom:e.value+"px",right:s.value+"px"}),onTouchstart:v,onTouchmove:g,onTouchend:f,onClick:y},{default:o((()=>[h.value?(i(),l(u,{key:0,class:"masks"})):L("",!0),n(u,{class:"icon"},{default:o((()=>[n(d,{type:"plusempty",size:"30"})])),_:1})])),_:1},8,["style"])}}},[["__scopeId","data-v-d5d4b0bb"]]),_t=R({__name:"PostPageTopSwiper",setup(t){const e=p([{name:"python"},{name:"android"},{name:"vim"},{name:"cpp"},{name:"django"},{name:"go"},{name:"json"},{name:"php"},{name:"powershell"},{name:"sass"}]),s=q((()=>{const t=[];for(let s=0;s<e.value.length;s+=8)t.push(e.value.slice(s,s+8));return t}));return(t,e)=>{const a=r,c=$,u=j;return i(),l(u,{"indicator-dots":""},{default:o((()=>[(i(!0),v(g,null,f(s.value,((t,e)=>(i(),l(c,{key:e,class:"swiper-item"},{default:o((()=>[(i(!0),v(g,null,f(t,(t=>(i(),l(a,{key:t.name,class:"icon-wrapper",onClick:e=>{S({url:`/pages/posts-page/posts-page?id=${t.name}`})}},{default:o((()=>[n(a,{class:y(["t-icon",`t-icon-${t.name}`,"icon"])},null,8,["class"]),n(a,{class:"icon-name"},{default:o((()=>[k(x(t.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:2},1024)))),128))])),_:1})}}},[["__scopeId","data-v-25c8736c"]]);const ht=R({},[["render",function(t,e){return null}]]),vt=R({__name:"ArticleWarp",setup(t){it().getUserData;const e=p([]),s=p([]),a=(t,e)=>{t.forEach((t=>{const s={postid:t._id,popular:parseInt(t.like)>10?1:0,sticky:0,featured:0,title:t.title,content:t.summary,img_url:t.images,usertx:t.authorDetails.avatar,nickname:t.authorDetails.username,update_time_ago:"Just now",view:parseInt(t.views)||0,thumbs:parseInt(t.like)||0,comment:t.comments.length||0};e.push(s)}))};return m((()=>{ot().then((t=>{e.value=t.data,a(e.value,s.value)}))})),(t,e)=>{const a=C,c=r,u=P,d=U,p=A(_("u-icon"),lt);return s.value.length>0?(i(),l(c,{key:0,class:"post-list"},{default:o((()=>[(i(!0),v(g,null,f(s.value,((t,e)=>(i(),l(c,{class:"post-list__item",key:e,onClick:e=>{return s=t.postid,void S({url:"/pages/article/article?id="+s});var s}},{default:o((()=>[n(c,{class:"post-list__item-status"},{default:o((()=>[1==t.popular?(i(),l(a,{key:0,class:"post-list__item-status-text"},{default:o((()=>[k("热")])),_:1})):L("",!0),1==t.sticky?(i(),l(a,{key:1,class:"post-list__item-status-text"},{default:o((()=>[k("顶")])),_:1})):L("",!0),1==t.featured?(i(),l(a,{key:2,class:"post-list__item-status-text"},{default:o((()=>[k("精")])),_:1})):L("",!0),n(c,{class:"post-list__item-title"},{default:o((()=>[k(x(t.title),1)])),_:2},1024)])),_:2},1024),n(c,{class:"post-list__item-content"},{default:o((()=>{return[k(x((e=t.content,e=(e=(e=(e=e.replace(/<[^<>]+>/g,"")).replace(/&nbsp;/gi,"")).replace(/<img*>/gi,"")).replace(/<video*>/gi,""))),1)];var e})),_:2},1024),t.img_url.length>0?(i(),l(c,{key:0,class:"post-list__item-img"},{default:o((()=>[(i(!0),v(g,null,f(t.img_url.slice(0,3),((t,e)=>(i(),l(u,{key:e,src:t,class:"post-list__item-img-item",mode:"aspectFill"},null,8,["src"])))),128))])),_:2},1024)):L("",!0),t.video_url?(i(),l(c,{key:1,class:"post-list__item-video"},{default:o((()=>[n(d,{src:t.video_url,class:"post-list__item-video-item",controls:""},null,8,["src"])])),_:2},1024)):L("",!0),n(c,{class:"post-list__item-user"},{default:o((()=>[n(c,{class:"post-list__item-user-left"},{default:o((()=>[n(u,{src:t.usertx,class:"post-list__item-user-avatar"},null,8,["src"]),n(c,{class:"post-list__item-user-name"},{default:o((()=>{return[k(x((e=t.nickname,e.length>5?e.substring(0,5)+"...":e))+" ",1),n(a,{style:{"margin-left":"20upx"}},{default:o((()=>[k(x(t.update_time_ago),1)])),_:2},1024)];var e})),_:2},1024)])),_:2},1024),n(c,{class:"post-list__item-user-right"},{default:o((()=>[n(c,{class:"post-list__item-user-right-item"},{default:o((()=>[n(p,{name:"eye-fill",color:"#666",size:"15"}),n(a,{class:"iconfont iconyanjing"}),n(a,{class:"post-list__item-user-right-item-text"},{default:o((()=>[k(x(t.view),1)])),_:2},1024)])),_:2},1024),n(c,{class:"post-list__item-user-right-item"},{default:o((()=>[n(p,{name:"thumb-up-fill",color:"#666",size:"15"}),n(a,{class:"post-list__item-user-right-item-text"},{default:o((()=>[k(x(t.thumbs),1)])),_:2},1024)])),_:2},1024),n(c,{class:"post-list__item-user-right-item"},{default:o((()=>[n(p,{name:"more-circle-fill",color:"#666",size:"15"}),n(a,{class:"post-list__item-user-right-item-text"},{default:o((()=>[k(x(t.comment),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):L("",!0)}}},[["__scopeId","data-v-1459a721"]]);const gt=R({name:"Lodding",data:()=>({})},[["render",function(t,e,s,a,l,o){return i(),v("div",{class:"loader"},[I("div",{class:"box box-1"},[I("div",{class:"side-left"}),I("div",{class:"side-right"}),I("div",{class:"side-top"})]),I("div",{class:"box box-2"},[I("div",{class:"side-left"}),I("div",{class:"side-right"}),I("div",{class:"side-top"})]),I("div",{class:"box box-3"},[I("div",{class:"side-left"}),I("div",{class:"side-right"}),I("div",{class:"side-top"})]),I("div",{class:"box box-4"},[I("div",{class:"side-left"}),I("div",{class:"side-right"}),I("div",{class:"side-top"})])])}],["__scopeId","data-v-9f425cd0"]]),ft=R({__name:"index",setup(t){p();const e=p(!0),s=p(!1);X((()=>{setTimeout((()=>{W()}),3e3)}));return Y((()=>{w("change-page",(t=>{(t=>{e.value=t})(t)})),B({success:t=>{},fail:t=>{}}),w("showLodding",(()=>{s.value=!0})),w("closeLodding",(()=>{s.value=!1}))})),(t,a)=>{const c=A(_("u-sticky"),nt),u=r;return i(),v(g,null,[n(u,{class:"content"},{default:o((()=>[n(ct),n(mt),J(n(u,{style:{"margin-top":"140rpx"}},{default:o((()=>[n(ut),n(rt),n(c,{"offset-top":"-1"},{default:o((()=>[n(pt)])),_:1}),n(dt)])),_:1},512),[[M,e.value]]),J(n(u,{style:{"margin-top":"140rpx"}},{default:o((()=>[n(ut),n(_t),n(ht),n(vt)])),_:1},512),[[M,!e.value]])])),_:1}),s.value?(i(),l(u,{key:0,class:"lodding"},{default:o((()=>[n(gt)])),_:1})):L("",!0)],64)}}},[["__scopeId","data-v-51966ab2"]]);export{ft as default};
