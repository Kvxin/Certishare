import{d as e,m as t,a as o,j as l,o as a,b as s,w as n,r as u,p as r,n as i,i as c,I as d,e as p,R as m,q as f,t as y,k as _,F as h,s as v,g,y as b,$ as w,z as k,T as C,U as x,h as S,x as B,u as $,V as I}from"./index-00d60881.js";import{_ as O}from"./uni-nav-bar.4d3ebaa8.js";import{r as z}from"./uni-app.es.321125a8.js";import{_ as T}from"./uni-icons.3d408e16.js";import{_ as j}from"./u-button.ee418497.js";import{_ as V}from"./u-line.9dc400b9.js";import{_ as R}from"./u-loading-icon.24b0e379.js";import{_ as A}from"./u-transition.2954decb.js";import{_ as H}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as N}from"./u-status-bar.79420d40.js";import{_ as U}from"./u-icon.69362ebb.js";import{u as M}from"./userStore.15830dc1.js";import{s as P}from"./request.708de9e4.js";import{u as D}from"./u-text.e368aedb.js";const F=H({name:"u-overlay",mixins:[t,o,{props:{show:{type:Boolean,default:e.overlay.show},zIndex:{type:[String,Number],default:e.overlay.zIndex},duration:{type:[String,Number],default:e.overlay.duration},opacity:{type:[String,Number],default:e.overlay.opacity}}}],computed:{overlayStyle(){const e={position:"fixed",top:0,left:0,right:0,zIndex:this.zIndex,bottom:0,"background-color":`rgba(0, 0, 0, ${this.opacity})`};return uni.$u.deepMerge(e,uni.$u.addStyle(this.customStyle))}},emits:["click"],methods:{clickHandler(){this.$emit("click")}}},[["render",function(e,t,o,r,i,c){const d=z(l("u-transition"),A);return a(),s(d,{show:e.show,"custom-class":"u-overlay",duration:e.duration,"custom-style":c.overlayStyle,onClick:c.clickHandler},{default:n((()=>[u(e.$slots,"default",{},void 0,!0)])),_:3},8,["show","duration","custom-style","onClick"])}],["__scopeId","data-v-82a76b03"]]);const E=H({name:"u-safe-bottom",mixins:[t,o,{props:{}}],data:()=>({safeAreaBottomHeight:0,isNvue:!1}),computed:{style(){return uni.$u.deepMerge({},uni.$u.addStyle(this.customStyle))}},mounted(){}},[["render",function(e,t,o,l,n,u){const d=c;return a(),s(d,{class:r(["u-safe-bottom",[!n.isNvue&&"u-safe-area-inset-bottom"]]),style:i([u.style])},null,8,["style","class"])}],["__scopeId","data-v-3dbbff38"]]);const L=H({name:"u-popup",mixins:[t,o,{props:{show:{type:Boolean,default:e.popup.show},overlay:{type:Boolean,default:e.popup.overlay},mode:{type:String,default:e.popup.mode},duration:{type:[String,Number],default:e.popup.duration},closeable:{type:Boolean,default:e.popup.closeable},overlayStyle:{type:[Object,String],default:e.popup.overlayStyle},closeOnClickOverlay:{type:Boolean,default:e.popup.closeOnClickOverlay},zIndex:{type:[String,Number],default:e.popup.zIndex},safeAreaInsetBottom:{type:Boolean,default:e.popup.safeAreaInsetBottom},safeAreaInsetTop:{type:Boolean,default:e.popup.safeAreaInsetTop},closeIconPos:{type:String,default:e.popup.closeIconPos},round:{type:[Boolean,String,Number],default:e.popup.round},zoom:{type:Boolean,default:e.popup.zoom},bgColor:{type:String,default:e.popup.bgColor},overlayOpacity:{type:[Number,String],default:e.popup.overlayOpacity}}}],data(){return{overlayDuration:this.duration+50}},watch:{show(e,t){}},computed:{transitionStyle(){const e={zIndex:this.zIndex,position:"fixed",display:"flex"};return e[this.mode]=0,"left"===this.mode||"right"===this.mode?uni.$u.deepMerge(e,{bottom:0,top:0}):"top"===this.mode||"bottom"===this.mode?uni.$u.deepMerge(e,{left:0,right:0}):"center"===this.mode?uni.$u.deepMerge(e,{alignItems:"center","justify-content":"center",top:0,left:0,right:0,bottom:0}):void 0},contentStyle(){const e={};if(uni.$u.sys(),"center"!==this.mode&&(e.flex=1),this.bgColor&&(e.backgroundColor=this.bgColor),this.round){const t=uni.$u.addUnit(this.round);"top"===this.mode?(e.borderBottomLeftRadius=t,e.borderBottomRightRadius=t):"bottom"===this.mode?(e.borderTopLeftRadius=t,e.borderTopRightRadius=t):"center"===this.mode&&(e.borderRadius=t)}return uni.$u.deepMerge(e,uni.$u.addStyle(this.customStyle))},position(){return"center"===this.mode?this.zoom?"fade-zoom":"fade":"left"===this.mode?"slide-left":"right"===this.mode?"slide-right":"bottom"===this.mode?"slide-up":"top"===this.mode?"slide-down":void 0}},emits:["open","close","click"],methods:{overlayClick(){this.closeOnClickOverlay&&this.$emit("close")},close(e){this.$emit("close")},afterEnter(){this.$emit("open")},clickHandler(){"center"===this.mode&&this.overlayClick(),this.$emit("click")}}},[["render",function(e,t,o,f,y,_){const h=z(l("u-overlay"),F),v=z(l("u-status-bar"),N),g=z(l("u-icon"),U),b=c,w=z(l("u-safe-bottom"),E),k=z(l("u-transition"),A);return a(),s(b,{class:"u-popup"},{default:n((()=>[e.overlay?(a(),s(h,{key:0,show:e.show,onClick:_.overlayClick,duration:y.overlayDuration,customStyle:e.overlayStyle,opacity:e.overlayOpacity},null,8,["show","onClick","duration","customStyle","opacity"])):d("",!0),p(k,{show:e.show,customStyle:_.transitionStyle,mode:_.position,duration:e.duration,onAfterEnter:_.afterEnter,onClick:_.clickHandler},{default:n((()=>[p(b,{class:"u-popup__content",style:i([_.contentStyle]),onClick:m(e.noop,["stop"])},{default:n((()=>[e.safeAreaInsetTop?(a(),s(v,{key:0})):d("",!0),u(e.$slots,"default",{},void 0,!0),e.closeable?(a(),s(b,{key:1,onClick:m(_.close,["stop"]),class:r(["u-popup__content__close",["u-popup__content__close--"+e.closeIconPos]]),"hover-class":"u-popup__content__close--hover","hover-stay-time":"150"},{default:n((()=>[p(g,{name:"close",color:"#909399",size:"18",bold:""})])),_:1},8,["onClick","class"])):d("",!0),e.safeAreaInsetBottom?(a(),s(w,{key:2})):d("",!0)])),_:3},8,["style","onClick"])])),_:3},8,["show","customStyle","mode","duration","onAfterEnter","onClick"])])),_:3})}],["__scopeId","data-v-27ba5882"]]);const q=H({name:"u-modal",mixins:[t,o,{props:{show:{type:Boolean,default:e.modal.show},title:{type:[String],default:e.modal.title},content:{type:String,default:e.modal.content},confirmText:{type:String,default:e.modal.confirmText},cancelText:{type:String,default:e.modal.cancelText},showConfirmButton:{type:Boolean,default:e.modal.showConfirmButton},showCancelButton:{type:Boolean,default:e.modal.showCancelButton},confirmColor:{type:String,default:e.modal.confirmColor},cancelColor:{type:String,default:e.modal.cancelColor},buttonReverse:{type:Boolean,default:e.modal.buttonReverse},zoom:{type:Boolean,default:e.modal.zoom},asyncClose:{type:Boolean,default:e.modal.asyncClose},closeOnClickOverlay:{type:Boolean,default:e.modal.closeOnClickOverlay},negativeTop:{type:[String,Number],default:e.modal.negativeTop},width:{type:[String,Number],default:e.modal.width},confirmButtonShape:{type:String,default:e.modal.confirmButtonShape}}}],data:()=>({loading:!1}),watch:{show(e){e&&this.loading&&(this.loading=!1)}},emits:["confirm","cancel","close"],methods:{confirmHandler(){this.asyncClose&&(this.loading=!0),this.$emit("confirm")},cancelHandler(){this.$emit("cancel")},clickHandler(){this.closeOnClickOverlay&&this.$emit("close")}}},[["render",function(e,t,o,m,g,b){const w=v,k=c,C=z(l("u-line"),V),x=z(l("u-loading-icon"),R),S=z(l("u-popup"),L);return a(),s(S,{mode:"center",zoom:e.zoom,show:e.show,customStyle:{borderRadius:"6px",overflow:"hidden",marginTop:`-${e.$u.addUnit(e.negativeTop)}`},closeOnClickOverlay:e.closeOnClickOverlay,safeAreaInsetBottom:!1,duration:400,onClick:b.clickHandler},{default:n((()=>[p(k,{class:"u-modal",style:i({width:e.$u.addUnit(e.width)})},{default:n((()=>[e.title?(a(),s(w,{key:0,class:"u-modal__title"},{default:n((()=>[f(y(e.title),1)])),_:1})):d("",!0),p(k,{class:"u-modal__content",style:i({paddingTop:(e.title?12:25)+"px"})},{default:n((()=>[u(e.$slots,"default",{},(()=>[p(w,{class:"u-modal__content__text"},{default:n((()=>[f(y(e.content),1)])),_:1})]),!0)])),_:3},8,["style"]),e.$slots.confirmButton?(a(),s(k,{key:1,class:"u-modal__button-group--confirm-button"},{default:n((()=>[u(e.$slots,"confirmButton",{},void 0,!0)])),_:3})):(a(),_(h,{key:2},[p(C),p(k,{class:"u-modal__button-group",style:i({flexDirection:e.buttonReverse?"row-reverse":"row"})},{default:n((()=>[e.showCancelButton?(a(),s(k,{key:0,class:r(["u-modal__button-group__wrapper u-modal__button-group__wrapper--cancel",[e.showCancelButton&&!e.showConfirmButton&&"u-modal__button-group__wrapper--only-cancel"]]),"hover-stay-time":150,"hover-class":"u-modal__button-group__wrapper--hover",onClick:b.cancelHandler},{default:n((()=>[p(w,{class:"u-modal__button-group__wrapper__text",style:i({color:e.cancelColor})},{default:n((()=>[f(y(e.cancelText),1)])),_:1},8,["style"])])),_:1},8,["class","onClick"])):d("",!0),e.showConfirmButton&&e.showCancelButton?(a(),s(C,{key:1,direction:"column"})):d("",!0),e.showConfirmButton?(a(),s(k,{key:2,class:r(["u-modal__button-group__wrapper u-modal__button-group__wrapper--confirm",[!e.showCancelButton&&e.showConfirmButton&&"u-modal__button-group__wrapper--only-confirm"]]),"hover-stay-time":150,"hover-class":"u-modal__button-group__wrapper--hover",onClick:b.confirmHandler},{default:n((()=>[g.loading?(a(),s(x,{key:0})):(a(),s(w,{key:1,class:"u-modal__button-group__wrapper__text",style:i({color:e.confirmColor})},{default:n((()=>[f(y(e.confirmText),1)])),_:1},8,["style"]))])),_:1},8,["class","onClick"])):d("",!0)])),_:1},8,["style"])],64))])),_:3},8,["style"])])),_:3},8,["zoom","show","customStyle","closeOnClickOverlay","onClick"])}],["__scopeId","data-v-fef61a0c"]]);const W=H({__name:"LoginWarp",emits:["toggle"],setup(e,{emit:t}){const o=g(!1),u=g(""),r=g(""),i=M(),d=()=>{w("changeFlipped")},m=()=>{u.value&&r.value?function(e,t){return P.post("/login",{email:e,password:t})}(u.value,r.value).then((e=>{const t={token:e.data.token,userData:e.data.userData};i.setUser(t),C({url:"/pages/index/index"})})).catch((e=>{k({title:"账号或密码填写错误",icon:"none"})})):k({title:"请填写所有字段",icon:"none"})},y=()=>{setTimeout((()=>{o.value=!1}),500)};return(e,t)=>{const i=v,_=x,h=c,g=z(l("up-button"),j),w=z(l("u-modal"),q);return a(),s(h,{class:"login-form-warp"},{default:n((()=>[p(h,{class:"login-form"},{default:n((()=>[p(h,{class:"username-input inputs"},{default:n((()=>[p(i,{class:"input-text"},{default:n((()=>[f("输入邮箱")])),_:1}),p(_,{type:"text",placeholder:"请输入邮箱",modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e)},null,8,["modelValue"])])),_:1}),p(h,{class:"password-input inputs"},{default:n((()=>[p(i,{class:"input-text"},{default:n((()=>[f("输入密码")])),_:1}),p(_,{type:"password",placeholder:"请输入密码",modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=e=>r.value=e)},null,8,["modelValue"])])),_:1}),p(h,{class:"no-account"},{default:n((()=>[b("p",{class:"p"},[f(" 没有账号? "),b("span",{onClick:d,class:"span"},"立即注册!")])])),_:1}),p(h,{class:"button-input"},{default:n((()=>[p(g,{type:"primary",text:"登录",shape:"circle",class:"login-button",onClick:m})])),_:1})])),_:1}),p(h,null,{default:n((()=>[p(w,{show:o.value,onConfirm:y,ref:"uModal",asyncClose:!0,closeOnClickOverlay:!0,zoom:!0,title:"提示"},null,8,["show"])])),_:1})])),_:1})}}},[["__scopeId","data-v-18f87b7c"]]);const G=H({__name:"RegisterWarp",emits:["toggle"],setup(e,{emit:t}){const o=g(!1);g("");const u=g("获取验证码"),r=g(null),i=g(""),d=g(""),m=g(""),y=()=>{w("changeFlipped")},_=()=>{(function(e){return P.post("/register",{userData:e})})({email:i.value,password:d.value,code:m.value}).then((e=>{w("changeFlipped")}))},h=()=>{i.value?function(e){return P.post("/sendVerification",{email:e})}(i.value).then((e=>{S()})):k({title:"请填写邮箱",icon:"none"})},C=()=>{setTimeout((()=>{o.value=!1}),500)},S=()=>{if(r.value)return;let e=60;u.value=`${e}秒`,r.value=setInterval((()=>{e--,u.value=`${e}秒`,e<=0&&(clearInterval(r.value),r.value=null,u.value="获取验证码")}),1e3)},B=()=>{i.value&&d.value&&m.value?(t("toggle"),_()):k({title:"请填写所有字段",icon:"none"})};return(e,t)=>{const r=v,_=x,g=c,w=z(l("up-text"),D),k=z(l("up-button"),j),S=z(l("u-modal"),q);return a(),s(g,{class:"register-form-warp"},{default:n((()=>[p(g,{class:"register-form"},{default:n((()=>[p(g,{class:"username-input inputs"},{default:n((()=>[p(r,{class:"input-text"},{default:n((()=>[f("输入邮箱")])),_:1}),p(_,{type:"text",placeholder:"请输入邮箱",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e)},null,8,["modelValue"])])),_:1}),p(g,{class:"password-input inputs"},{default:n((()=>[p(r,{class:"input-text"},{default:n((()=>[f("输入密码")])),_:1}),p(_,{type:"password",placeholder:"请输入密码",modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e)},null,8,["modelValue"])])),_:1}),p(g,{class:"password-input inputs code"},{default:n((()=>[p(r,{class:"input-text"},{default:n((()=>[f("输入验证码")])),_:1}),p(g,{class:"code-warp"},{default:n((()=>[p(_,{type:"text",placeholder:"请输入验证码",modelValue:m.value,"onUpdate:modelValue":t[2]||(t[2]=e=>m.value=e)},null,8,["modelValue"]),p(w,{text:u.value,type:"primary",onClick:h},null,8,["text"])])),_:1})])),_:1}),p(g,{class:"no-account"},{default:n((()=>[b("p",{class:"p"},[f(" 已有账号? "),b("span",{onClick:y,class:"span"},"返回登录")])])),_:1}),p(g,{class:"button-input"},{default:n((()=>[p(k,{type:"primary",text:"注册",shape:"circle",class:"register-button",onClick:B})])),_:1})])),_:1}),p(g,null,{default:n((()=>[p(S,{show:o.value,onConfirm:C,ref:"uModal",asyncClose:!0,closeOnClickOverlay:!0,zoom:!0,title:"提示"},null,8,["show"])])),_:1})])),_:1})}}},[["__scopeId","data-v-1234f076"]]),J={login:{loginPage:{text:{title:"欢迎回来！",prompt:"输入账号密码以登录或者注册一个账户"},field:{username:"输入邮箱或者用户名",password:"输入密码",placeholder:{username:"请输入邮箱",password:"请输入密码"},tips:{p:"没有账号?",span:"立即注册!"},model:"提示",button:"登录"}}}},K=H({__name:"login",setup(e){J.login.loginPage.field,g(!0);const t=g(!1),o=g(!1),u=()=>{I()};return S((()=>{B("changeFlipped",(()=>{t.value=!t.value,setTimeout((()=>{o.value=t.value}),300)}))})),(e,i)=>{const d=z(l("uni-nav-bar"),O),m=z(l("uni-icons"),T),f=c;return a(),s(f,{class:"login-page",style:{width:"100%"}},{default:n((()=>[p(d,{border:!1,"background-color":"#fafafa"}),p(f,{class:"back"},{default:n((()=>[p(m,{type:"arrow-left",size:"32",onClick:u})])),_:1}),p(f,{class:"login-top"},{default:n((()=>[b("h1",null,y($(J).login.loginPage.text.title),1),b("p",{class:"pp"},y($(J).login.loginPage.text.prompt),1)])),_:1}),p(f,{class:"login-warp"},{default:n((()=>[p(f,{class:r(["login-div",{"is-flipped":t.value}])},{default:n((()=>[p(f,{class:r(["r",{hide:o.value}])},{default:n((()=>[p(W)])),_:1},8,["class"]),p(f,{class:r(["r back-warp",{hide:!o.value}])},{default:n((()=>[p(G)])),_:1},8,["class"])])),_:1},8,["class"])])),_:1}),p(f,{class:"login-other"}),p(f,{class:"login-bottom"}),p(f)])),_:1})}}},[["__scopeId","data-v-82e33498"]]);export{K as default};
