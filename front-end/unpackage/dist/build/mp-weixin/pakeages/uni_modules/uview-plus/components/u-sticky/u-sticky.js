"use strict";const i=require("../../../../common/vendor.js"),s=require("./props.js"),e=require("../../libs/mixin/mpMixin.js"),r=require("../../libs/mixin/mixin.js");require("../../libs/config/props.js"),require("../../libs/config/props/actionSheet.js"),require("../../libs/config/props/album.js"),require("../../libs/config/props/alert.js"),require("../../libs/config/props/avatar.js"),require("../../libs/config/props/avatarGroup.js"),require("../../libs/config/props/backtop.js"),require("../../libs/config/props/badge.js"),require("../../libs/config/props/button.js"),require("../../libs/config/props/calendar.js"),require("../../libs/config/props/carKeyboard.js"),require("../../libs/config/props/cell.js"),require("../../libs/config/props/cellGroup.js"),require("../../libs/config/props/checkbox.js"),require("../../libs/config/props/checkboxGroup.js"),require("../../libs/config/props/circleProgress.js"),require("../../libs/config/props/code.js"),require("../../libs/config/props/codeInput.js"),require("../../libs/config/props/col.js"),require("../../libs/config/props/collapse.js"),require("../../libs/config/props/collapseItem.js"),require("../../libs/config/props/columnNotice.js"),require("../../libs/config/props/countDown.js"),require("../../libs/config/props/countTo.js"),require("../../libs/config/props/datetimePicker.js"),require("../../libs/config/props/divider.js"),require("../../libs/config/props/empty.js"),require("../../libs/config/props/form.js"),require("../../libs/config/props/formItem.js"),require("../../libs/config/props/gap.js"),require("../../libs/config/props/grid.js"),require("../../libs/config/props/gridItem.js"),require("../../libs/config/props/icon.js"),require("../../libs/config/config.js"),require("../../libs/config/props/image.js"),require("../../libs/config/props/indexAnchor.js"),require("../../libs/config/props/indexList.js"),require("../../libs/config/props/input.js"),require("../../libs/config/props/keyboard.js"),require("../../libs/config/props/line.js"),require("../../libs/config/props/lineProgress.js"),require("../../libs/config/props/link.js"),require("../../libs/config/props/list.js"),require("../../libs/config/props/listItem.js"),require("../../libs/config/props/loadingIcon.js"),require("../../libs/config/props/loadingPage.js"),require("../../libs/config/props/loadmore.js"),require("../../libs/config/props/modal.js"),require("../../libs/config/props/navbar.js"),require("../../libs/config/color.js"),require("../../libs/config/props/noNetwork.js"),require("../../libs/config/props/noticeBar.js"),require("../../libs/config/props/notify.js"),require("../../libs/config/props/numberBox.js"),require("../../libs/config/props/numberKeyboard.js"),require("../../libs/config/props/overlay.js"),require("../../libs/config/props/parse.js"),require("../../libs/config/props/picker.js"),require("../../libs/config/props/popup.js"),require("../../libs/config/props/radio.js"),require("../../libs/config/props/radioGroup.js"),require("../../libs/config/props/rate.js"),require("../../libs/config/props/readMore.js"),require("../../libs/config/props/row.js"),require("../../libs/config/props/rowNotice.js"),require("../../libs/config/props/scrollList.js"),require("../../libs/config/props/search.js"),require("../../libs/config/props/section.js"),require("../../libs/config/props/skeleton.js"),require("../../libs/config/props/slider.js"),require("../../libs/config/props/statusBar.js"),require("../../libs/config/props/steps.js"),require("../../libs/config/props/stepsItem.js"),require("../../libs/config/props/sticky.js"),require("../../libs/config/props/subsection.js"),require("../../libs/config/props/swipeAction.js"),require("../../libs/config/props/swipeActionItem.js"),require("../../libs/config/props/swiper.js"),require("../../libs/config/props/swipterIndicator.js"),require("../../libs/config/props/switch.js"),require("../../libs/config/props/tabbar.js"),require("../../libs/config/props/tabbarItem.js"),require("../../libs/config/props/tabs.js"),require("../../libs/config/props/tag.js"),require("../../libs/config/props/text.js"),require("../../libs/config/props/textarea.js"),require("../../libs/config/props/toast.js"),require("../../libs/config/props/toolbar.js"),require("../../libs/config/props/tooltip.js"),require("../../libs/config/props/transition.js"),require("../../libs/config/props/upload.js");const o={name:"u-sticky",mixins:[e.mpMixin,r.mixin,s.props],data:()=>({cssSticky:!1,stickyTop:0,elId:i.index.$u.guid(),left:0,width:"auto",height:"auto",fixed:!1}),computed:{style(){const s={};return this.disabled?s.position="static":this.cssSticky?(s.position="sticky",s.zIndex=this.uZindex,s.top=i.index.$u.addUnit(this.stickyTop)):s.height=this.fixed?this.height+"px":"auto",s.backgroundColor=this.bgColor,i.index.$u.deepMerge(i.index.$u.addStyle(this.customStyle),s)},stickyContent(){const i={};return this.cssSticky||(i.position=this.fixed?"fixed":"static",i.top=this.stickyTop+"px",i.left=this.left+"px",i.width="auto"==this.width?"auto":this.width+"px",i.zIndex=this.uZindex),i},uZindex(){return this.zIndex?this.zIndex:i.index.$u.zIndex.sticky}},mounted(){this.init()},methods:{init(){this.getStickyTop(),this.checkSupportCssSticky(),this.cssSticky||!this.disabled&&this.initObserveContent()},initObserveContent(){this.$uGetRect("#"+this.elId).then((i=>{this.height=i.height,this.left=i.left,this.width=i.width,this.$nextTick((()=>{this.observeContent()}))}))},observeContent(){this.disconnectObserver("contentObserver");const s=i.index.createIntersectionObserver({thresholds:[.95,.98,1]});s.relativeToViewport({top:-this.stickyTop}),s.observe(`#${this.elId}`,(i=>{this.setFixed(i.boundingClientRect.top)})),this.contentObserver=s},setFixed(i){const s=i<=this.stickyTop;this.fixed=s},disconnectObserver(i){const s=this[i];s&&s.disconnect()},getStickyTop(){this.stickyTop=i.index.$u.getPx(this.offsetTop)+i.index.$u.getPx(this.customNavHeight)},async checkSupportCssSticky(){"android"===i.index.$u.os()&&Number(i.index.$u.sys().system)>8&&(this.cssSticky=!0),this.cssSticky=await this.checkComputedStyle(),"ios"===i.index.$u.os()&&(this.cssSticky=!0)},checkComputedStyle(){return new Promise((s=>{i.index.createSelectorQuery().in(this).select(".u-sticky").fields({computedStyle:["position"]}).exec((i=>{s("sticky"===i[0].position)}))}))},checkCssStickyForH5(){}},beforeUnmount(){this.disconnectObserver("contentObserver")}};const t=i._export_sfc(o,[["render",function(s,e,r,o,t,p){return{a:i.s(p.stickyContent),b:t.elId,c:i.s(p.style)}}],["__scopeId","data-v-ea57325d"]]);wx.createComponent(t);
